<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocolo IA - Oficial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body { background-color: #050505; color: white; font-family: 'Inter', sans-serif; }
        .central { max-width: 900px; margin: 0 auto; }
        .card-red { border: 1px solid #ff000033; background: #0a0a0a; box-shadow: 0 0 20px #ff000011; }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="central flex flex-col items-center text-center">
        <h1 class="text-5xl font-black italic text-white tracking-tighter">PROTOCOLO <span class="text-red-600">2.0</span></h1>
        <p class="text-gray-500 text-xs mt-2 uppercase tracking-[0.3em]">Gestão de Alavancagem Kwanza (AOA)</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-12 w-full text-left">
            
            <div class="card-red p-6 rounded-2xl space-y-4">
                <h3 class="text-red-600 font-bold uppercase text-[10px]">Entrada de Dados</h3>
                <textarea id="dados" class="w-full h-32 bg-black border border-gray-800 rounded-xl p-3 text-sm focus:border-red-600 outline-none" placeholder="Cole os multiplicadores..."></textarea>
                
                <div class="border-2 border-dashed border-gray-800 p-4 rounded-xl text-center hover:border-red-600 transition-all">
                    <input type="file" id="imagem" class="hidden" onchange="analisarFoto()">
                    <label for="imagem" class="cursor-pointer text-xs text-gray-500 italic">Clique para Upload de Print do Gráfico</label>
                </div>
                
                <button onclick="enviarTexto()" class="w-full bg-red-600 py-4 rounded-xl font-black uppercase tracking-widest hover:bg-red-700 transition-all">Analisar Fluxo</button>
            </div>

            <div class="bg-white/5 border-l-4 border-red-600 p-6 rounded-r-2xl flex flex-col justify-between">
                <div>
                    <h3 class="text-white font-bold text-lg mb-4 italic">Estratégias & Dicas</h3>
                    <div id="output-box" class="space-y-4">
                        <p id="estrategia" class="text-gray-400 text-sm italic">Aguardando dados para aplicar o manual...</p>
                        <div id="badge-alerta" class="hidden bg-red-600/20 border border-red-600 p-2 rounded text-[10px] font-bold text-red-500 text-center uppercase tracking-widest">ALERTA CRÍTICO</div>
                    </div>
                </div>
                
                <div class="mt-8 border-t border-gray-800 pt-4">
                    <p class="text-[10px] text-gray-600 font-mono">MOEDA: KWANZA (AOA) | STATUS: CONECTADO</p>
                </div>
            </div>

        </div>
    </div>

    <script>
        const socket = io('https://seu-backend-no-render.onrender.com');

        function enviarTexto() {
            const val = document.getElementById('dados').value;
            if(val) socket.emit('input_mercado', val);
        }

        async function analisarFoto() {
            const fileInput = document.getElementById('imagem');
            const formData = new FormData();
            formData.append('imagem', fileInput.files[0]);

            document.getElementById('estrategia').innerText = "Analisando pixels da imagem conforme manual...";

            const res = await fetch('https://seu-backend-no-render.onrender.com/analisar-imagem', {
                method: 'POST',
                body: formData
            });
            const data = await res.json();
            document.getElementById('estrategia').innerText = data.resultado;
        }

        socket.on('output_ia', (data) => {
            document.getElementById('estrategia').innerText = data.estrategia + " \n\nDica: " + data.dica;
            document.getElementById('badge-alerta').style.display = 'block';
        });
    </script>
</body>
</html>
